var poly,map;var markers=[];var path=new google.maps.MVCArray;function map_initialize(){map=new google.maps.Map(document.getElementById("map"),{zoom:19,mapTypeId:google.maps.MapTypeId.SATELLITE,tilt:0,center:{lat:54,lng:-2}});map.setOptions({draggableCursor:"crosshair",scrollwheel:false});poly=new google.maps.Polygon({strokeWeight:3,fillColor:"#fea739",strokeColor:"#fea739"});poly.setMap(map);poly.setPaths(new google.maps.MVCArray([path]));google.maps.event.addListener(map,"click",addPoint);var a=new google.maps.Geocoder();geocodeAddress(a,map)}function addPoint(b){path.insertAt(path.length,b.latLng);var a=new google.maps.Marker({position:b.latLng,map:map,draggable:true,icon:{path:google.maps.SymbolPath.CIRCLE,scale:4}});markers.push(a);a.setTitle("#"+path.length);google.maps.event.addListener(a,"click",function(){a.setMap(null);for(var d=0,c=markers.length;d<c&&markers[d]!=a;++d){}markers.splice(d,1);path.removeAt(d);updateArea()});google.maps.event.addListener(a,"drag",function(){for(var d=0,c=markers.length;d<c&&markers[d]!=a;++d){}path.setAt(d,a.getPosition());updateArea()});updateArea()}function updateArea(){var a=google.maps.geometry.spherical.computeArea(poly.getPath());a=Math.round((a+0.00001)*100)/100;document.getElementById("area").value=(a)+" sqm"}function geocodeAddress(b,c){var a=document.getElementById("postcode").innerHTML;b.geocode({address:a},function(f,e){if(e===google.maps.GeocoderStatus.OK){c.setCenter(f[0].geometry.location);c.setZoom(19);c.setOptions({draggableCursor:"crosshair"});var d=new google.maps.Marker({map:c,position:f[0].geometry.location})}else{alert("Geocoding failed for the following reason:"+e)}})}function get_area(){document.getElementById("nextBtn").addEventListener("click",function(){var a=document.getElementById("area").value;request.session.area=a})}$(document).ready(function(){map_initialize();get_area()});